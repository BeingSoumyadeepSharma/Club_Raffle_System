(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{4162:function(e,t,s){Promise.resolve().then(s.t.bind(s,6327,23)),Promise.resolve().then(s.t.bind(s,6876,23)),Promise.resolve().then(s.bind(s,8937)),Promise.resolve().then(s.bind(s,8046)),Promise.resolve().then(s.bind(s,6768))},8937:function(e,t,s){"use strict";s.r(t),s.d(t,{Navbar:function(){return Y}});var a=s(7573),r=s(7653),n=s(2056),i=s.n(n),l=s(2859),o=s(3061),d=s(8046),c=s(6768),u=s(747),m=s(4416),f=s(9484),h=s(7342);let x=m.fC,p=m.xz;m.x8;let g=m.h_,j=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(m.aV,{className:(0,o.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...r,ref:t})});j.displayName=m.aV.displayName;let N=(0,f.j)("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),v=r.forwardRef((e,t)=>{let{side:s="right",className:r,children:n,...i}=e;return(0,a.jsxs)(g,{children:[(0,a.jsx)(j,{}),(0,a.jsxs)(m.VY,{ref:t,className:(0,o.cn)(N({side:s}),r),...i,children:[n,(0,a.jsxs)(m.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[(0,a.jsx)(h.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});v.displayName=m.VY.displayName,r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(m.Dx,{ref:t,className:(0,o.cn)("text-lg font-semibold text-foreground",s),...r})}).displayName=m.Dx.displayName,r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(m.dk,{ref:t,className:(0,o.cn)("text-sm text-muted-foreground",s),...r})}).displayName=m.dk.displayName;var b=s(1656),y=s(9075),w=s(8869),k=s(5950),C=s(6469),S=s(7781),z=s(2151),_=s(9583),P=s(8154),Z=s(8544),L=s(310),E=s(7369),A=s(9218),R=s(6120),I=s(6801),T=s(8151),O=s(5453),B=s(8875),V=s(8852);let D=s(4850).env.NEXT_PUBLIC_API_URL||"http://localhost:3000/api";function F(e){let{trigger:t}=e,{user:s,updateRafflerName:n,refreshUser:i}=(0,d.useAuth)(),[l,o]=(0,r.useState)(!1),[c,m]=(0,r.useState)(""),[f,h]=(0,r.useState)(""),[x,p]=(0,r.useState)(!1),[g,j]=(0,r.useState)(""),[N,v]=(0,r.useState)(!1),[b,y]=(0,r.useState)(""),[w,k]=(0,r.useState)(!1),[C,S]=(0,r.useState)(!1),z=async()=>{if(s){if(j(""),v(!1),c.length<4){j("Password must be at least 4 characters");return}if(c!==f){j("Passwords do not match");return}p(!0);try{let e=await fetch("".concat(D,"/auth/users/").concat(s.id,"/password"),{method:"PATCH",headers:{"Content-Type":"application/json",...(0,d.getAuthHeaders)()},body:JSON.stringify({password:c})});if(e.ok)v(!0),m(""),h(""),setTimeout(()=>v(!1),3e3);else{let t=await e.json();j(t.error||"Failed to update password")}}catch(e){j("Failed to update password")}finally{p(!1)}}},_=async()=>{if(s){k(!0);try{await n(b)&&(S(!0),setTimeout(()=>S(!1),3e3))}finally{k(!1)}}};return s?(0,a.jsxs)(T.Vq,{open:l,onOpenChange:e=>{o(e),e&&s&&y(s.rafflerName||""),e||(m(""),h(""),j(""),v(!1),S(!1))},children:[(0,a.jsx)(T.hg,{asChild:!0,children:t||(0,a.jsx)(u.z,{variant:"ghost",size:"icon",title:"Profile Settings",children:(0,a.jsx)(O.Z,{className:"h-5 w-5"})})}),(0,a.jsxs)(T.cZ,{className:"sm:max-w-[425px]",children:[(0,a.jsxs)(T.fK,{children:[(0,a.jsxs)(T.$N,{className:"flex items-center gap-2",children:[(0,a.jsx)(O.Z,{className:"h-5 w-5"}),"Profile Settings"]}),(0,a.jsx)(T.Be,{children:"Update your account settings"})]}),(0,a.jsxs)("div",{className:"space-y-6 py-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(I._,{className:"text-muted-foreground",children:"Account"}),(0,a.jsx)("div",{className:"flex items-center gap-2 p-3 bg-muted rounded-md",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:s.username}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:d.ROLE_LABELS[s.role]})]})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(I._,{htmlFor:"rafflerName",className:"flex items-center gap-2",children:[(0,a.jsx)(B.Z,{className:"h-4 w-4"}),"Raffler Name"]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"This name auto-fills when purchasing tickets or making announcements"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(R.I,{id:"rafflerName",value:b,onChange:e=>y(e.target.value),placeholder:"Enter your raffler name"}),(0,a.jsx)(u.z,{onClick:_,disabled:w,variant:C?"outline":"default",children:w?"...":C?"âœ“ Saved":"Save"})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(I._,{className:"flex items-center gap-2",children:[(0,a.jsx)(V.Z,{className:"h-4 w-4"}),"Change Password"]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(R.I,{type:"password",value:c,onChange:e=>m(e.target.value),placeholder:"New password (min 4 characters)"}),(0,a.jsx)(R.I,{type:"password",value:f,onChange:e=>h(e.target.value),placeholder:"Confirm new password"}),g&&(0,a.jsx)("p",{className:"text-sm text-red-500",children:g}),N&&(0,a.jsx)("p",{className:"text-sm text-green-500",children:"Password updated successfully!"}),(0,a.jsx)(u.z,{onClick:z,disabled:x||!c||!f,className:"w-full",children:x?"Updating...":"Update Password"})]})]})]}),(0,a.jsx)(T.cN,{children:(0,a.jsx)(u.z,{variant:"outline",onClick:()=>o(!1),children:"Close"})})]})]}):null}let U=[{href:"/",label:"Dashboard",icon:b.Z},{href:"/entities",label:"Clubs",icon:y.Z},{href:"/tickets",label:"Tickets",icon:w.Z}],H={superuser:k.Z,club_owner:C.Z,event_manager:S.Z,staff:z.Z};function Y(){let e=(0,l.usePathname)(),t=(0,l.useRouter)(),{user:s,logout:n,isLoading:m,canManageUsers:f}=(0,d.useAuth)(),{theme:h,toggleTheme:g}=(0,c.useTheme)(),[j,N]=(0,r.useState)(!1),b=()=>{n(),t.push("/login")},y=s?H[s.role]:null,w=t=>{let{mobile:r=!1}=t;return(0,a.jsxs)(a.Fragment,{children:[U.map(t=>{let n=t.icon,l=e===t.href;return"/"===t.href&&(null==s?void 0:s.role)!=="superuser"?null:(0,a.jsxs)(i(),{href:t.href,onClick:()=>r&&N(!1),className:(0,o.cn)("flex items-center gap-2 text-sm font-medium transition-colors hover:text-primary",l?"text-primary":"text-muted-foreground",r&&"py-2"),children:[(0,a.jsx)(n,{className:"h-4 w-4"}),t.label]},t.href)}),f()&&(0,a.jsxs)(i(),{href:"/users",onClick:()=>r&&N(!1),className:(0,o.cn)("flex items-center gap-2 text-sm font-medium transition-colors hover:text-primary","/users"===e?"text-primary":"text-muted-foreground",r&&"py-2"),children:[(0,a.jsx)(z.Z,{className:"h-4 w-4"}),"Users"]})]})};return(0,a.jsx)("nav",{className:"border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:(0,a.jsxs)("div",{className:"container flex h-16 items-center justify-between px-4",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsxs)(i(),{href:"/",className:"flex items-center gap-2 font-bold text-xl mr-8",children:["\uD83C\uDFB2 ",(0,a.jsx)("span",{className:"hidden sm:inline",children:"Raffle System"})]}),(0,a.jsx)("div",{className:"hidden md:flex items-center gap-6",children:(0,a.jsx)(w,{})})]}),(0,a.jsxs)("div",{className:"hidden md:flex items-center gap-4",children:[(0,a.jsx)(u.z,{variant:"ghost",size:"icon",onClick:g,title:"dark"===h?"Switch to light mode":"Switch to dark mode",children:"dark"===h?(0,a.jsx)(_.Z,{className:"h-5 w-5"}):(0,a.jsx)(P.Z,{className:"h-5 w-5"})}),m?(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"Loading..."}):s?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(F,{}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[y&&(0,a.jsx)(y,{className:"h-4 w-4 text-primary"}),(0,a.jsx)("span",{children:s.username}),(0,a.jsxs)("span",{className:"text-xs text-muted-foreground hidden lg:inline",children:["(",d.ROLE_LABELS[s.role],")"]})]}),(0,a.jsxs)(u.z,{variant:"outline",size:"sm",onClick:b,className:"gap-2",children:[(0,a.jsx)(Z.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"Logout"})]})]}):(0,a.jsx)(u.z,{variant:"outline",size:"sm",asChild:!0,className:"gap-2",children:(0,a.jsxs)(i(),{href:"/login",children:[(0,a.jsx)(L.Z,{className:"h-4 w-4"}),"Login"]})})]}),(0,a.jsxs)("div",{className:"md:hidden flex items-center gap-2",children:[(0,a.jsx)(u.z,{variant:"ghost",size:"icon",onClick:g,children:"dark"===h?(0,a.jsx)(_.Z,{className:"h-5 w-5"}):(0,a.jsx)(P.Z,{className:"h-5 w-5"})}),s&&(0,a.jsxs)("div",{className:"flex items-center gap-1 text-sm",children:[y&&(0,a.jsx)(y,{className:"h-4 w-4 text-primary"}),(0,a.jsx)("span",{className:"text-xs",children:s.username})]}),(0,a.jsxs)(x,{open:j,onOpenChange:N,modal:!0,children:[(0,a.jsx)(p,{asChild:!0,children:(0,a.jsx)(u.z,{variant:"ghost",size:"icon",children:(0,a.jsx)(E.Z,{className:"h-5 w-5"})})}),(0,a.jsx)(v,{side:"right",className:"w-[280px]",onInteractOutside:()=>N(!1),children:(0,a.jsxs)("div",{className:"flex flex-col gap-4 mt-8",children:[(0,a.jsx)(w,{mobile:!0}),(0,a.jsx)("div",{className:"border-t pt-4 mt-4",children:m?(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"Loading..."}):s?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[y&&(0,a.jsx)(y,{className:"h-4 w-4 text-primary"}),(0,a.jsx)("span",{children:s.username}),(0,a.jsxs)("span",{className:"text-xs text-muted-foreground",children:["(",d.ROLE_LABELS[s.role],")"]})]}),(0,a.jsx)(F,{trigger:(0,a.jsxs)(u.z,{variant:"outline",size:"sm",className:"w-full gap-2",children:[(0,a.jsx)(A.Z,{className:"h-4 w-4"}),"Profile Settings"]})}),(0,a.jsxs)(u.z,{variant:"outline",size:"sm",onClick:()=>{b(),N(!1)},className:"w-full gap-2",children:[(0,a.jsx)(Z.Z,{className:"h-4 w-4"}),"Logout"]})]}):(0,a.jsx)(u.z,{variant:"outline",size:"sm",asChild:!0,className:"w-full gap-2",children:(0,a.jsxs)(i(),{href:"/login",onClick:()=>N(!1),children:[(0,a.jsx)(L.Z,{className:"h-4 w-4"}),"Login"]})})})]})})]})]})]})})}},747:function(e,t,s){"use strict";s.d(t,{z:function(){return d}});var a=s(7573),r=s(7653),n=s(432),i=s(9484),l=s(3061);let o=(0,i.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=r.forwardRef((e,t)=>{let{className:s,variant:r,size:i,asChild:d=!1,...c}=e,u=d?n.g7:"button";return(0,a.jsx)(u,{className:(0,l.cn)(o({variant:r,size:i,className:s})),ref:t,...c})});d.displayName="Button"},8151:function(e,t,s){"use strict";s.d(t,{$N:function(){return x},Be:function(){return p},Vq:function(){return o},cN:function(){return h},cZ:function(){return m},fK:function(){return f},hg:function(){return d}});var a=s(7573),r=s(7653),n=s(4416),i=s(7342),l=s(3061);let o=n.fC,d=n.xz,c=n.h_;n.x8;let u=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.aV,{ref:t,className:(0,l.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...r})});u.displayName=n.aV.displayName;let m=r.forwardRef((e,t)=>{let{className:s,children:r,...o}=e;return(0,a.jsxs)(c,{children:[(0,a.jsx)(u,{}),(0,a.jsxs)(n.VY,{ref:t,className:(0,l.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...o,children:[r,(0,a.jsxs)(n.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,a.jsx)(i.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});m.displayName=n.VY.displayName;let f=e=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,l.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...s})};f.displayName="DialogHeader";let h=e=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,l.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...s})};h.displayName="DialogFooter";let x=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.Dx,{ref:t,className:(0,l.cn)("text-lg font-semibold leading-none tracking-tight",s),...r})});x.displayName=n.Dx.displayName;let p=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.dk,{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",s),...r})});p.displayName=n.dk.displayName},6120:function(e,t,s){"use strict";s.d(t,{I:function(){return i}});var a=s(7573),r=s(7653),n=s(3061);let i=r.forwardRef((e,t)=>{let{className:s,type:r,...i}=e;return(0,a.jsx)("input",{type:r,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:t,...i})});i.displayName="Input"},6801:function(e,t,s){"use strict";s.d(t,{_:function(){return d}});var a=s(7573),r=s(7653),n=s(5962),i=s(9484),l=s(3061);let o=(0,i.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.f,{ref:t,className:(0,l.cn)(o(),s),...r})});d.displayName=n.f.displayName},8046:function(e,t,s){"use strict";s.r(t),s.d(t,{AuthProvider:function(){return o},ROLE_LABELS:function(){return i},getAuthHeaders:function(){return c},useAuth:function(){return d}});var a=s(7573),r=s(7653);let n=s(4850).env.NEXT_PUBLIC_API_URL||"http://localhost:3000/api",i={superuser:"Superuser",club_owner:"Club Owner",event_manager:"Event Manager",staff:"Staff"},l=(0,r.createContext)(void 0);function o(e){let{children:t}=e,[s,i]=(0,r.useState)(null),[o,d]=(0,r.useState)(null),[c,u]=(0,r.useState)(!0);(0,r.useEffect)(()=>{let e=localStorage.getItem("auth_token");e?(d(e),m(e)):u(!1)},[]);let m=async e=>{try{let t=await fetch("".concat(n,"/auth/me"),{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){let e=await t.json();i(e.data)}else localStorage.removeItem("auth_token"),d(null)}catch(e){console.error("Failed to fetch user:",e),localStorage.removeItem("auth_token"),d(null)}finally{u(!1)}},f=async(e,t)=>{try{let s=await fetch("".concat(n,"/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:t})}),a=await s.json();if(a.success&&a.data)return d(a.data.token),localStorage.setItem("auth_token",a.data.token),await m(a.data.token),!0;return!1}catch(e){return console.error("Login failed:",e),!1}},h=async e=>{if(!s||!o)return!1;try{if((await fetch("".concat(n,"/auth/users/").concat(s.id,"/raffler-name"),{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(o)},body:JSON.stringify({rafflerName:e})})).ok)return i({...s,rafflerName:e}),!0;return!1}catch(e){return console.error("Failed to update raffler name:",e),!1}},x=async()=>{o&&await m(o)};return(0,a.jsx)(l.Provider,{value:{user:s,token:o,isLoading:c,login:f,logout:()=>{i(null),d(null),localStorage.removeItem("auth_token")},hasAccessToEntity:e=>!!s&&("superuser"===s.role||s.assignedEntities.includes(e)),canCreateClubs:()=>(null==s?void 0:s.role)==="superuser",canEditClubInfo:()=>!!s&&("superuser"===s.role||"club_owner"===s.role||"event_manager"===s.role),canManageUsers:()=>!!s&&"staff"!==s.role,updateRafflerName:h,refreshUser:x},children:t})}function d(){let e=(0,r.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}function c(){let e=localStorage.getItem("auth_token");return e?{Authorization:"Bearer ".concat(e)}:{}}},6768:function(e,t,s){"use strict";s.r(t),s.d(t,{ThemeProvider:function(){return i},useTheme:function(){return l}});var a=s(7573),r=s(7653);let n=(0,r.createContext)(void 0);function i(e){let{children:t}=e,[s,i]=(0,r.useState)("dark"),[l,o]=(0,r.useState)(!1);(0,r.useEffect)(()=>{o(!0);let e=localStorage.getItem("theme");if(e)i(e),d(e);else{let e=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";i(e),d(e)}},[]);let d=e=>{let t=document.documentElement;"dark"===e?t.classList.add("dark"):t.classList.remove("dark")},c=e=>{i(e),localStorage.setItem("theme",e),d(e)};return l?(0,a.jsx)(n.Provider,{value:{theme:s,toggleTheme:()=>{c("dark"===s?"light":"dark")},setTheme:c},children:t}):null}function l(){let e=(0,r.useContext)(n);if(void 0===e)throw Error("useTheme must be used within a ThemeProvider");return e}},3061:function(e,t,s){"use strict";s.d(t,{cn:function(){return n}});var a=s(794),r=s(9654);function n(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,r.m6)((0,a.W)(t))}},6327:function(){}},function(e){e.O(0,[791,904,557,293,16,744],function(){return e(e.s=4162)}),_N_E=e.O()}]);