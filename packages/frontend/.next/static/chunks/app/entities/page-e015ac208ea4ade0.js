(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[146],{5044:function(e,s,t){Promise.resolve().then(t.bind(t,8035))},8035:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return w}});var a=t(7573),l=t(7653),r=t(2859),n=t(8603),i=t(747),c=t(6120),d=t(6801),u=t(961),o=t(3061);let x=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsxs)(u.fC,{ref:s,className:(0,o.cn)("relative flex w-full touch-none select-none items-center",t),...l,children:[(0,a.jsx)(u.fQ,{className:"relative h-1.5 w-full grow overflow-hidden rounded-full bg-primary/20",children:(0,a.jsx)(u.e6,{className:"absolute h-full bg-primary"})}),(0,a.jsx)(u.bU,{className:"block h-4 w-4 rounded-full border border-primary/50 bg-background shadow transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50"})]})});x.displayName=u.fC.displayName;var m=t(8151),h=t(8314),g=t(7917);let p=["\uD83C\uDFB2","\uD83C\uDFB0","\uD83C\uDFAD","\uD83C\uDFAF","\uD83D\uDC8E","\uD83D\uDC51","\uD83C\uDF1F","\uD83C\uDF12","\uD83D\uDDA4\uD83D\uDDA4\uD83D\uDDA4"];function j(e){let{onSuccess:s}=e,[t,r]=(0,l.useState)(!1),[n,u]=(0,l.useState)(!1),[o,j]=(0,l.useState)(""),[f,N]=(0,l.useState)(""),[v,D]=(0,l.useState)("\uD83C\uDFB2"),[b,C]=(0,l.useState)("Thanks for your Purchase.. and good luck~"),[y,w]=(0,l.useState)(70),F=async e=>{e.preventDefault(),u(!0);try{let e=await (0,h.JP)({name:o.toLowerCase().replace(/\s+/g,"-"),displayName:f,emoji:v,tagline:b,rafflePercentage:y});e&&(null==s||s(e),r(!1),j(""),N(""),D("\uD83C\uDFB2"),C("Thanks for your Purchase.. and good luck~"),w(70))}catch(e){console.error("Failed to create entity:",e)}finally{u(!1)}};return(0,a.jsxs)(m.Vq,{open:t,onOpenChange:r,children:[(0,a.jsx)(m.hg,{asChild:!0,children:(0,a.jsxs)(i.z,{variant:"outline",className:"gap-2",children:[(0,a.jsx)(g.Z,{className:"h-4 w-4"}),"Create Club"]})}),(0,a.jsxs)(m.cZ,{className:"sm:max-w-[425px]",children:[(0,a.jsxs)(m.fK,{children:[(0,a.jsx)(m.$N,{children:"Create New Club Entity"}),(0,a.jsx)(m.Be,{children:"Create a new club for your raffle system."})]}),(0,a.jsxs)("form",{onSubmit:F,children:[(0,a.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(d._,{htmlFor:"displayName",children:"Club Name"}),(0,a.jsx)(c.I,{id:"displayName",value:f,onChange:e=>{N(e.target.value),j(e.target.value.toLowerCase().replace(/\s+/g,"-"))},placeholder:"e.g., GODFATHER'S CLUB",required:!0})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(d._,{children:"Select Emoji"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:p.map(e=>(0,a.jsx)("button",{type:"button",onClick:()=>D(e),className:"text-2xl p-2 rounded-lg border-2 transition-colors ".concat(v===e?"border-primary bg-primary/10":"border-transparent hover:border-muted-foreground/30"),children:e},e))})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(d._,{htmlFor:"tagline",children:"Tagline"}),(0,a.jsx)(c.I,{id:"tagline",value:b,onChange:e=>C(e.target.value),placeholder:"Enter a catchy tagline"})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsxs)(d._,{children:["Prize Percentage: ",y,"%"]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(x,{value:[y],onValueChange:e=>w(e[0]),min:10,max:100,step:5,className:"flex-1"}),(0,a.jsxs)("span",{className:"text-sm text-muted-foreground w-12 text-right",children:[y,"%"]})]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Percentage of revenue allocated for the prize pool"})]}),(0,a.jsxs)("div",{className:"rounded-lg bg-muted p-4 text-center",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:"Preview"}),(0,a.jsxs)("p",{className:"text-lg font-bold",children:[v," ",f||"CLUB NAME"," ",v]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:b}),(0,a.jsxs)("p",{className:"text-xs text-amber-500 mt-2",children:["\uD83C\uDFC6 Prize: ",y,"% of revenue"]})]})]}),(0,a.jsx)(m.cN,{children:(0,a.jsx)(i.z,{type:"submit",disabled:n||!f,children:n?"Creating...":"Create Club"})})]})]})]})}var f=t(8875);let N=["\uD83C\uDFB2","\uD83C\uDFB0","\uD83C\uDFAD","\uD83C\uDFAF","\uD83D\uDC8E","\uD83D\uDC51","\uD83C\uDF1F","\uD83C\uDF12","\uD83D\uDDA4\uD83D\uDDA4\uD83D\uDDA4"];function v(e){var s;let{entity:t,onSuccess:r}=e,[n,u]=(0,l.useState)(!1),[o,g]=(0,l.useState)(!1),[p,j]=(0,l.useState)(t.displayName),[v,D]=(0,l.useState)(t.emoji),[b,C]=(0,l.useState)(t.tagline),[y,w]=(0,l.useState)(null!==(s=t.rafflePercentage)&&void 0!==s?s:70),F=async e=>{e.preventDefault(),g(!0);try{let e=await (0,h.i8)(t.id,{displayName:p,emoji:v,tagline:b,rafflePercentage:y});e&&(null==r||r(e),u(!1))}catch(e){console.error("Failed to update entity:",e)}finally{g(!1)}};return(0,a.jsxs)(m.Vq,{open:n,onOpenChange:e=>{if(e){var s;j(t.displayName),D(t.emoji),C(t.tagline),w(null!==(s=t.rafflePercentage)&&void 0!==s?s:70)}u(e)},children:[(0,a.jsx)(m.hg,{asChild:!0,children:(0,a.jsx)(i.z,{variant:"outline",size:"icon",title:"Edit Club",children:(0,a.jsx)(f.Z,{className:"h-4 w-4"})})}),(0,a.jsxs)(m.cZ,{className:"sm:max-w-[425px]",children:[(0,a.jsxs)(m.fK,{children:[(0,a.jsx)(m.$N,{children:"Edit Club Entity"}),(0,a.jsx)(m.Be,{children:"Update the club settings and raffle percentage."})]}),(0,a.jsxs)("form",{onSubmit:F,children:[(0,a.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(d._,{htmlFor:"displayName",children:"Club Name"}),(0,a.jsx)(c.I,{id:"displayName",value:p,onChange:e=>j(e.target.value),placeholder:"e.g., GODFATHER'S CLUB",required:!0})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(d._,{children:"Select Emoji"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:N.map(e=>(0,a.jsx)("button",{type:"button",onClick:()=>D(e),className:"text-2xl p-2 rounded-lg border-2 transition-colors ".concat(v===e?"border-primary bg-primary/10":"border-transparent hover:border-muted-foreground/30"),children:e},e))})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(d._,{htmlFor:"tagline",children:"Tagline"}),(0,a.jsx)(c.I,{id:"tagline",value:b,onChange:e=>C(e.target.value),placeholder:"Enter a catchy tagline"})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsxs)(d._,{children:["Prize Percentage: ",y,"%"]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(x,{value:[y],onValueChange:e=>w(e[0]),min:10,max:100,step:5,className:"flex-1"}),(0,a.jsxs)("span",{className:"text-sm text-muted-foreground w-12 text-right",children:[y,"%"]})]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Percentage of revenue allocated for the prize pool"})]}),(0,a.jsxs)("div",{className:"rounded-lg bg-muted p-4 text-center",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:"Preview"}),(0,a.jsxs)("p",{className:"text-lg font-bold",children:[v," ",p||"CLUB NAME"," ",v]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:b}),(0,a.jsxs)("p",{className:"text-xs text-amber-500 mt-2",children:["\uD83C\uDFC6 Prize: ",y,"% of revenue"]})]})]}),(0,a.jsx)(m.cN,{children:(0,a.jsx)(i.z,{type:"submit",disabled:o||!p,children:o?"Saving...":"Save Changes"})})]})]})]})}var D=t(999),b=t(8046),C=t(3062),y=t(8073);function w(){let[e,s]=(0,l.useState)([]),[t,c]=(0,l.useState)(!0),{user:d,isLoading:u,canCreateClubs:o}=(0,b.useAuth)(),x=(0,r.useRouter)();(0,l.useEffect)(()=>{u||d||x.push("/login")},[d,u,x]);let m=!u&&o(),g=(null==d?void 0:d.role)==="superuser",p=async()=>{try{let e=await (0,h.uc)();s(e)}catch(e){console.error("Failed to load entities:",e)}finally{c(!1)}};(0,l.useEffect)(()=>{d&&p()},[d]);let f=async e=>{confirm("Are you sure you want to delete this club?")&&(await (0,h.Ks)(e),p())};return u||!d||t?(0,a.jsx)("div",{className:"flex items-center justify-center h-[60vh]",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-4xl mb-4",children:"\uD83C\uDFE2"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Loading..."})]})}):(0,a.jsxs)("div",{className:"space-y-6 md:space-y-8",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold tracking-tight",children:"Club Entities"}),(0,a.jsx)("p",{className:"text-muted-foreground text-sm sm:text-base",children:"Manage your raffle club entities"})]}),m&&(0,a.jsx)(j,{onSuccess:p})]}),0===e.length?(0,a.jsxs)(D.Zb,{className:"p-6 sm:p-12 text-center",children:[(0,a.jsx)("div",{className:"text-4xl sm:text-6xl mb-4",children:"\uD83C\uDFE2"}),(0,a.jsx)("h3",{className:"text-lg sm:text-xl font-semibold mb-2",children:"No Clubs Yet"}),(0,a.jsx)("p",{className:"text-sm sm:text-base text-muted-foreground mb-4",children:m?"Create your first club entity to start selling raffle tickets.":"No clubs available. Contact a superuser to create one."}),m&&(0,a.jsx)(j,{onSuccess:p})]}):(0,a.jsx)("div",{className:"grid gap-3 sm:gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3",children:e.map(e=>(0,a.jsxs)("div",{className:"relative group",children:[(0,a.jsx)(n.m,{entity:e}),(0,a.jsxs)("div",{className:"absolute top-2 right-2 flex gap-1 opacity-100 sm:opacity-0 sm:group-hover:opacity-100 transition-opacity",children:[(0,a.jsx)(i.z,{variant:"outline",size:"icon",asChild:!0,children:(0,a.jsx)("a",{href:(0,h.oQ)(e.id),download:!0,title:"Export to Excel",children:(0,a.jsx)(C.Z,{className:"h-4 w-4"})})}),(0,a.jsx)(v,{entity:e,onSuccess:p}),g&&(0,a.jsx)(i.z,{variant:"destructive",size:"icon",onClick:()=>f(e.id),children:(0,a.jsx)(y.Z,{className:"h-4 w-4"})})]})]},e.id))})]})}},8603:function(e,s,t){"use strict";t.d(s,{m:function(){return n}});var a=t(7573),l=t(999),r=t(44);function n(e){var s;let{entity:t,onClick:n,selected:i}=e;return(0,a.jsxs)(l.Zb,{className:"cursor-pointer transition-all hover:shadow-lg ".concat(i?"ring-2 ring-primary":""),onClick:n,children:[(0,a.jsxs)(l.Ol,{className:"pb-2 p-3 sm:p-6 sm:pb-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-3xl sm:text-4xl",children:t.emoji}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-1 sm:gap-2 justify-end",children:[(0,a.jsxs)(r.C,{variant:"outline",className:"text-amber-500 border-amber-500 text-xs",children:["\uD83C\uDFC6 ",null!==(s=t.rafflePercentage)&&void 0!==s?s:70,"%"]}),(0,a.jsx)(r.C,{variant:i?"default":"secondary",className:"text-xs",children:t.name})]})]}),(0,a.jsx)(l.ll,{className:"text-lg sm:text-xl",children:t.displayName}),(0,a.jsx)(l.SZ,{className:"text-xs sm:text-sm line-clamp-2",children:t.tagline})]}),(0,a.jsx)(l.aY,{className:"p-3 pt-0 sm:p-6 sm:pt-0",children:(0,a.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Created: ",new Date(t.createdAt).toLocaleDateString()]})})]})}}},function(e){e.O(0,[801,136,284,393,540,293,16,744],function(){return e(e.s=5044)}),_N_E=e.O()}]);