(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{1608:function(e,t,s){Promise.resolve().then(s.t.bind(s,6876,23)),Promise.resolve().then(s.t.bind(s,6327,23)),Promise.resolve().then(s.bind(s,9985)),Promise.resolve().then(s.bind(s,8046)),Promise.resolve().then(s.bind(s,6768))},9985:function(e,t,s){"use strict";s.r(t),s.d(t,{Navbar:function(){return I}});var a=s(7573),r=s(7653),n=s(2056),i=s.n(n),o=s(2859),l=s(3061),c=s(8046),d=s(6768),u=s(747),m=s(4416),h=s(9484),f=s(7342);let x=m.fC,g=m.xz;m.x8;let p=m.h_,v=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(m.aV,{className:(0,l.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...r,ref:t})});v.displayName=m.aV.displayName;let b=(0,h.j)("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),j=r.forwardRef((e,t)=>{let{side:s="right",className:r,children:n,...i}=e;return(0,a.jsxs)(p,{children:[(0,a.jsx)(v,{}),(0,a.jsxs)(m.VY,{ref:t,className:(0,l.cn)(b({side:s}),r),...i,children:[n,(0,a.jsxs)(m.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[(0,a.jsx)(f.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});j.displayName=m.VY.displayName,r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(m.Dx,{ref:t,className:(0,l.cn)("text-lg font-semibold text-foreground",s),...r})}).displayName=m.Dx.displayName,r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(m.dk,{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",s),...r})}).displayName=m.dk.displayName;var N=s(1656),y=s(9075),w=s(8869),k=s(5950),C=s(6469),S=s(7781),_=s(2151),z=s(9583),L=s(8154),E=s(8544),Z=s(310),A=s(7369);let P=[{href:"/",label:"Dashboard",icon:N.Z},{href:"/entities",label:"Clubs",icon:y.Z},{href:"/tickets",label:"Tickets",icon:w.Z}],T={superuser:k.Z,club_owner:C.Z,event_manager:S.Z,staff:_.Z};function I(){let e=(0,o.usePathname)(),t=(0,o.useRouter)(),{user:s,logout:n,isLoading:m,canManageUsers:h}=(0,c.useAuth)(),{theme:f,toggleTheme:p}=(0,d.useTheme)(),[v,b]=(0,r.useState)(!1),N=()=>{n(),t.push("/login")},y=s?T[s.role]:null,w=t=>{let{mobile:r=!1}=t;return(0,a.jsxs)(a.Fragment,{children:[P.map(t=>{let n=t.icon,o=e===t.href;return"/"===t.href&&(null==s?void 0:s.role)!=="superuser"?null:(0,a.jsxs)(i(),{href:t.href,onClick:()=>r&&b(!1),className:(0,l.cn)("flex items-center gap-2 text-sm font-medium transition-colors hover:text-primary",o?"text-primary":"text-muted-foreground",r&&"py-2"),children:[(0,a.jsx)(n,{className:"h-4 w-4"}),t.label]},t.href)}),h()&&(0,a.jsxs)(i(),{href:"/users",onClick:()=>r&&b(!1),className:(0,l.cn)("flex items-center gap-2 text-sm font-medium transition-colors hover:text-primary","/users"===e?"text-primary":"text-muted-foreground",r&&"py-2"),children:[(0,a.jsx)(_.Z,{className:"h-4 w-4"}),"Users"]})]})};return(0,a.jsx)("nav",{className:"border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:(0,a.jsxs)("div",{className:"container flex h-16 items-center justify-between px-4",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsxs)(i(),{href:"/",className:"flex items-center gap-2 font-bold text-xl mr-8",children:["\uD83C\uDFB2 ",(0,a.jsx)("span",{className:"hidden sm:inline",children:"Raffle System"})]}),(0,a.jsx)("div",{className:"hidden md:flex items-center gap-6",children:(0,a.jsx)(w,{})})]}),(0,a.jsxs)("div",{className:"hidden md:flex items-center gap-4",children:[(0,a.jsx)(u.z,{variant:"ghost",size:"icon",onClick:p,title:"dark"===f?"Switch to light mode":"Switch to dark mode",children:"dark"===f?(0,a.jsx)(z.Z,{className:"h-5 w-5"}):(0,a.jsx)(L.Z,{className:"h-5 w-5"})}),m?(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"Loading..."}):s?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[y&&(0,a.jsx)(y,{className:"h-4 w-4 text-primary"}),(0,a.jsx)("span",{children:s.username}),(0,a.jsxs)("span",{className:"text-xs text-muted-foreground hidden lg:inline",children:["(",c.ROLE_LABELS[s.role],")"]})]}),(0,a.jsxs)(u.z,{variant:"outline",size:"sm",onClick:N,className:"gap-2",children:[(0,a.jsx)(E.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"Logout"})]})]}):(0,a.jsx)(u.z,{variant:"outline",size:"sm",asChild:!0,className:"gap-2",children:(0,a.jsxs)(i(),{href:"/login",children:[(0,a.jsx)(Z.Z,{className:"h-4 w-4"}),"Login"]})})]}),(0,a.jsxs)("div",{className:"md:hidden flex items-center gap-2",children:[(0,a.jsx)(u.z,{variant:"ghost",size:"icon",onClick:p,children:"dark"===f?(0,a.jsx)(z.Z,{className:"h-5 w-5"}):(0,a.jsx)(L.Z,{className:"h-5 w-5"})}),s&&(0,a.jsxs)("div",{className:"flex items-center gap-1 text-sm",children:[y&&(0,a.jsx)(y,{className:"h-4 w-4 text-primary"}),(0,a.jsx)("span",{className:"text-xs",children:s.username})]}),(0,a.jsxs)(x,{open:v,onOpenChange:b,children:[(0,a.jsx)(g,{asChild:!0,children:(0,a.jsx)(u.z,{variant:"ghost",size:"icon",children:(0,a.jsx)(A.Z,{className:"h-5 w-5"})})}),(0,a.jsx)(j,{side:"right",className:"w-[280px]",children:(0,a.jsxs)("div",{className:"flex flex-col gap-4 mt-8",children:[(0,a.jsx)(w,{mobile:!0}),(0,a.jsx)("div",{className:"border-t pt-4 mt-4",children:m?(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"Loading..."}):s?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[y&&(0,a.jsx)(y,{className:"h-4 w-4 text-primary"}),(0,a.jsx)("span",{children:s.username}),(0,a.jsxs)("span",{className:"text-xs text-muted-foreground",children:["(",c.ROLE_LABELS[s.role],")"]})]}),(0,a.jsxs)(u.z,{variant:"outline",size:"sm",onClick:()=>{N(),b(!1)},className:"w-full gap-2",children:[(0,a.jsx)(E.Z,{className:"h-4 w-4"}),"Logout"]})]}):(0,a.jsx)(u.z,{variant:"outline",size:"sm",asChild:!0,className:"w-full gap-2",children:(0,a.jsxs)(i(),{href:"/login",onClick:()=>b(!1),children:[(0,a.jsx)(Z.Z,{className:"h-4 w-4"}),"Login"]})})})]})})]})]})]})})}},747:function(e,t,s){"use strict";s.d(t,{z:function(){return c}});var a=s(7573),r=s(7653),n=s(432),i=s(9484),o=s(3061);let l=(0,i.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=r.forwardRef((e,t)=>{let{className:s,variant:r,size:i,asChild:c=!1,...d}=e,u=c?n.g7:"button";return(0,a.jsx)(u,{className:(0,o.cn)(l({variant:r,size:i,className:s})),ref:t,...d})});c.displayName="Button"},8046:function(e,t,s){"use strict";s.r(t),s.d(t,{AuthProvider:function(){return l},ROLE_LABELS:function(){return i},getAuthHeaders:function(){return d},useAuth:function(){return c}});var a=s(7573),r=s(7653);let n=s(4850).env.NEXT_PUBLIC_API_URL||"http://localhost:3000/api",i={superuser:"Superuser",club_owner:"Club Owner",event_manager:"Event Manager",staff:"Staff"},o=(0,r.createContext)(void 0);function l(e){let{children:t}=e,[s,i]=(0,r.useState)(null),[l,c]=(0,r.useState)(null),[d,u]=(0,r.useState)(!0);(0,r.useEffect)(()=>{let e=localStorage.getItem("auth_token");e?(c(e),m(e)):u(!1)},[]);let m=async e=>{try{let t=await fetch("".concat(n,"/auth/me"),{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){let e=await t.json();i(e.data)}else localStorage.removeItem("auth_token"),c(null)}catch(e){console.error("Failed to fetch user:",e),localStorage.removeItem("auth_token"),c(null)}finally{u(!1)}},h=async(e,t)=>{try{let s=await fetch("".concat(n,"/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:t})}),a=await s.json();if(a.success&&a.data)return c(a.data.token),localStorage.setItem("auth_token",a.data.token),await m(a.data.token),!0;return!1}catch(e){return console.error("Login failed:",e),!1}},f=async e=>{if(!s||!l)return!1;try{if((await fetch("".concat(n,"/auth/users/").concat(s.id,"/raffler-name"),{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(l)},body:JSON.stringify({rafflerName:e})})).ok)return i({...s,rafflerName:e}),!0;return!1}catch(e){return console.error("Failed to update raffler name:",e),!1}},x=async()=>{l&&await m(l)};return(0,a.jsx)(o.Provider,{value:{user:s,token:l,isLoading:d,login:h,logout:()=>{i(null),c(null),localStorage.removeItem("auth_token")},hasAccessToEntity:e=>!!s&&("superuser"===s.role||s.assignedEntities.includes(e)),canCreateClubs:()=>(null==s?void 0:s.role)==="superuser",canEditClubInfo:()=>!!s&&("superuser"===s.role||"club_owner"===s.role||"event_manager"===s.role),canManageUsers:()=>!!s&&"staff"!==s.role,updateRafflerName:f,refreshUser:x},children:t})}function c(){let e=(0,r.useContext)(o);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}function d(){let e=localStorage.getItem("auth_token");return e?{Authorization:"Bearer ".concat(e)}:{}}},6768:function(e,t,s){"use strict";s.r(t),s.d(t,{ThemeProvider:function(){return i},useTheme:function(){return o}});var a=s(7573),r=s(7653);let n=(0,r.createContext)(void 0);function i(e){let{children:t}=e,[s,i]=(0,r.useState)("dark"),[o,l]=(0,r.useState)(!1);(0,r.useEffect)(()=>{l(!0);let e=localStorage.getItem("theme");if(e)i(e),c(e);else{let e=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";i(e),c(e)}},[]);let c=e=>{let t=document.documentElement;"dark"===e?t.classList.add("dark"):t.classList.remove("dark")},d=e=>{i(e),localStorage.setItem("theme",e),c(e)};return o?(0,a.jsx)(n.Provider,{value:{theme:s,toggleTheme:()=>{d("dark"===s?"light":"dark")},setTheme:d},children:t}):null}function o(){let e=(0,r.useContext)(n);if(void 0===e)throw Error("useTheme must be used within a ThemeProvider");return e}},3061:function(e,t,s){"use strict";s.d(t,{cn:function(){return n}});var a=s(794),r=s(9654);function n(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,r.m6)((0,a.W)(t))}},6327:function(){}},function(e){e.O(0,[801,136,764,293,16,744],function(){return e(e.s=1608)}),_N_E=e.O()}]);